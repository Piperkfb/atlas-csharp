The strcture of this code is important
